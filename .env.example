# ==================================
# DATABASE
# ==================================
# Supabase PostgreSQL Connection
# Format: postgresql://postgres.[PROJECT-REF]:[PASSWORD]@aws-0-sa-east-1.pooler.supabase.com:6543/postgres
DATABASE_URL=postgresql://postgres.xxxx:password@aws-0-sa-east-1.pooler.supabase.com:6543/postgres

# ==================================
# SERVER
# ==================================
PORT=5000
NODE_ENV=development

# ==================================
# SECURITY - Critical Secrets
# ==================================
# ⚠️  NEVER commit these values to git
# ⚠️  Generate strong secrets with: npm run generate:secret
# ⚠️  Rotate secrets every 90 days: npm run rotate:secrets
# ⚠️  Validate secrets before deploy: npm run validate:secrets

# Session Secret (REQUIRED in production)
# This secret is used to sign session cookies. Using the default value in production
# is a CRITICAL security vulnerability that can lead to session hijacking.
# Minimum 32 characters, recommended 64+
#
# Generate with: openssl rand -base64 64
# Or run: npm run generate:secret
#
# ⚠️ CRITICAL REQUIREMENTS:
#   - Minimum 32 characters required
#   - Default/weak secrets will be REJECTED in production
#   - The server will FAIL TO START if validation fails
#   - Use different secrets for each environment
#   - Rotate periodically (e.g., every 90 days)
SESSION_SECRET=your-super-secret-session-key-change-in-production

# Cookie Domain (optional - for multi-subdomain setup)
# Leave empty for automatic domain detection (recommended for most cases)
# Only set this if you need cookies to work across subdomains
# Examples:
#   .imobibase.com (works on imobibase.com and *.imobibase.com)
#   localhost (for local development)
COOKIE_DOMAIN=

# CSRF Secret (auto-generated if not provided)
# Recommended to set explicitly for consistency across instances
# Generate with: openssl rand -base64 32
CSRF_SECRET=

# Encryption Key for sensitive data (optional)
# Used for encrypting OAuth tokens, API keys, etc
# Generate with: openssl rand -base64 32
ENCRYPTION_KEY=

# Last Secret Rotation Date (for tracking)
# Format: YYYY-MM-DD
# Update this date every time you rotate secrets
LAST_SECRET_ROTATION=

# ==================================
# MONITORING & ERROR TRACKING
# ==================================
# Sentry DSN for error tracking (get from sentry.io)
SENTRY_DSN=https://xxxxxxxxxxxxxxxxxxxxxxxxxxxxx@o0000000.ingest.sentry.io/0000000

# Sentry Frontend (Vite)
VITE_SENTRY_DSN=https://xxxxxxxxxxxxxxxxxxxxxxxxxxxxx@o0000000.ingest.sentry.io/0000000

# Sentry Build Configuration (for source maps upload)
SENTRY_ORG=your-org-name
SENTRY_PROJECT=your-project-name
SENTRY_AUTH_TOKEN=your-auth-token

# Vercel Git SHA (auto-populated in Vercel)
VITE_VERCEL_GIT_COMMIT_SHA=auto

# ==================================
# EMAIL SERVICE
# ==================================
# SendGrid API Key (https://sendgrid.com)
SENDGRID_API_KEY=SG.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# OR Resend API Key (https://resend.com) - Alternative to SendGrid
RESEND_API_KEY=re_xxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Email sender configuration
EMAIL_FROM=noreply@imobibase.com
EMAIL_FROM_NAME=ImobiBase

# ==================================
# EXTERNAL APIs
# ==================================
# Rotate these when:
# - Suspected compromise
# - Developer offboarding
# - Every 12 months

# PAYMENT GATEWAYS
# Stripe (Global markets)
# Pattern: sk_test_* (development) or sk_live_* (production)
STRIPE_SECRET_KEY=your_stripe_secret_key_here
STRIPE_PUBLISHABLE_KEY=your_stripe_publishable_key_here
STRIPE_WEBHOOK_SECRET=your_stripe_webhook_secret_here

# Mercado Pago (Brazil)
MERCADOPAGO_ACCESS_TOKEN=APP_USR-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
MERCADOPAGO_PUBLIC_KEY=APP_USR-xxxxxxxx-xxxxxx-xx

# COMMUNICATION
# WhatsApp Business API
# Minimum 20 characters for security
WHATSAPP_API_TOKEN=EAAxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
WHATSAPP_PHONE_NUMBER_ID=000000000000000
WHATSAPP_BUSINESS_ACCOUNT_ID=000000000000000

# WhatsApp Webhook Security
# APP_SECRET: Your Meta App Secret (found in Meta Developer Console > App Settings > Basic)
# VERIFY_TOKEN: A random string you create for webhook verification (use any random string)
WHATSAPP_APP_SECRET=your-app-secret-from-meta-developer-console
WHATSAPP_VERIFY_TOKEN=your-random-verify-token-here

# SMS Gateway (Twilio)
TWILIO_ACCOUNT_SID=ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
TWILIO_AUTH_TOKEN=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
TWILIO_PHONE_NUMBER=+5511999999999

# EMAIL
# SendGrid API Key (pattern must start with "SG.")
SENDGRID_API_KEY=SG.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# MAPPING
# Google Maps API Key (pattern must start with "AIza")
GOOGLE_MAPS_API_KEY=AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

# E-SIGNATURE
# ClickSign (E-signature for Brazil)
CLICKSIGN_API_KEY=xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx

# ClickSign Webhook Security - CRITICAL SECURITY: Must be set in production!
# This secret is used to validate webhook signatures from ClickSign using HMAC-SHA256.
# Without this, webhooks WILL BE REJECTED to prevent unauthorized requests.
#
# Generate a strong random secret with one of these commands:
#   openssl rand -hex 32
#   node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#
# ⚠️ IMPORTANT: The webhook handler will FAIL if this is not set!
# Configure this in your ClickSign dashboard webhook settings.
CLICKSIGN_WEBHOOK_SECRET=your-clicksign-webhook-secret-change-in-production

# ==================================
# SUPABASE (Auth & Storage)
# ==================================
SUPABASE_URL=https://xxxxxxxxxxxxxxxxxxxxx.supabase.co
SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IiIsInJvbGUiOiJhbm9uIiwiaWF0IjoxNjAwMDAwMDAwLCJleHAiOjE5MTU1MzYwMDB9.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
SUPABASE_SERVICE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IiIsInJvbGUiOiJzZXJ2aWNlX3JvbGUiLCJpYXQiOjE2MDAwMDAwMDAsImV4cCI6MTkxNTUzNjAwMH0.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

# ==================================
# CACHING & BACKGROUND JOBS
# ==================================
# Redis (Upstash or self-hosted)
REDIS_URL=redis://default:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx@xxxxx.upstash.io:6379

# ==================================
# ANALYTICS
# ==================================
# PostHog (Product Analytics & Feature Flags)
POSTHOG_API_KEY=phc_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
POSTHOG_HOST=https://app.posthog.com
VITE_POSTHOG_API_KEY=phc_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
VITE_POSTHOG_HOST=https://app.posthog.com

# Google Analytics 4
GOOGLE_ANALYTICS_ID=G-XXXXXXXXXX
VITE_GOOGLE_ANALYTICS_ID=G-XXXXXXXXXX

# ==================================
# DEPLOYMENT
# ==================================
# Vercel (auto-populated in production)
# VERCEL_GIT_COMMIT_SHA=auto
# VERCEL_URL=auto

# ==================================
# SECURITY
# ==================================
# CORS Configuration
# Comma-separated list of allowed origins
# Use * for wildcard subdomains: https://*.imobibase.com
# IMPORTANT: Remove localhost origins in production!
# Examples:
#   Development: http://localhost:5000,http://localhost:5173,https://imobibase.com
#   Production: https://imobibase.com,https://www.imobibase.com,https://*.imobibase.com
CORS_ORIGINS=http://localhost:5000,http://localhost:5173,https://imobibase.com,https://*.imobibase.com

# Rate Limiting (requests per window)
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
